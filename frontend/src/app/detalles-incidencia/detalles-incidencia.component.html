<div class="container">
  <!-- Barra de navegación simplificada -->
  <div class="nav-bar">
    <div class="nav-left">
      <button (click)="goBack()" class="nav-button" title="Volver"><i class="fas fa-arrow-left"></i></button>
    </div>
    <div class="nav-right">
      <button (click)="exportarIncidencia(incidencia)" class="nav-button" title="Exportar"><i class="fas fa-download"></i></button>
      <button (click)="importarIncidencia()" class="nav-button" title="Importar"><i class="fas fa-upload"></i></button>
    </div>
  </div>

  <!-- Mapa -->
  <div class="map">
    <app-map></app-map>
  </div>

  <!-- Detalles de la incidencia -->
  <div class="card">
    <div class="card-header">
      <h2>Detalles de la incidencia</h2>
    </div>
    <div class="card-content">
      <div class="details-grid">
        <div class="details-column">
          <div class="detail-item">
            <h3>Código de la incidencia</h3>
            <p><strong>{{incidencia.instalacion}}</strong></p>
          </div>
          <div class="detail-item">
            <h3>Elemento</h3>
            <p>{{incidencia.elemento}}</p>
          </div>
          <div class="detail-item">
            <h3>Ubicación</h3>
            <p>{{incidencia.ubicacion}}</p>
          </div>
          <div class="detail-item">
            <h3>Tipo</h3>
            <p>{{getTipoValor()}}</p>
          </div>
          <div class="detail-item">
            <h3>Tipo de afección</h3>
            <p>{{getTipoAfeccionValor()}}</p>
          </div>
        </div>
        <div class="details-column">
          <div class="detail-item">
            <h3>Disciplina</h3>
            <p>{{incidencia.tipo}}</p>
          </div>
          <div class="detail-item">
            <h3>Estado</h3>
            <div class="estado-badge" [style.backgroundColor]="getEstadoBgColor(incidencia.estado)" [style.color]="getEstadoColor(incidencia.estado)">
              {{incidencia.estado}}
            </div>
          </div>
          <div class="detail-item">
            <h3>Estado funcional</h3>
            <p>{{getEstadoFuncionalValor()}}</p>
          </div>
          <div class="detail-item">
            <h3>Nivel de criticidad</h3>
            <p>{{getNivelCriticidadValor()}}</p>
          </div>
          <div class="detail-item">
            <h3>Entidad responsable</h3>
            <p>{{getEntidadResponsableValor()}}</p>
          </div>
          <div class="detail-item">
            <h3>Fecha</h3>
            <p>{{incidencia.fecha}}</p>
          </div>
        </div>
      </div>

      <div class="detail-item">
        <h3>Observaciones</h3>
        <div class="observation-box">
          <p>{{getObservacionesTexto()}}</p>
        </div>
      </div>

      <div class="detail-item">
        <h3>Fotos</h3>
        <div class="photos-box">
          <img [src]="getFotoUrl()" alt="Foto de la incidencia" (error)="fotoError=true">
          <p *ngIf="fotoError">No hay fotos para esta incidencia</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Botones de acción -->
  <div class="actions">
    <button class="btn-outline" (click)="goBack()">Cancelar</button>
    <button (click)="editarIncidencia(incidencia)" class="boton-editar">Editar incidencia</button>
  </div>
</div>
